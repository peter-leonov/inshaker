<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
	<meta name="viewport" content="width=device-width"/>
	<title>Tests for LocationHash</title>
	<script src="tests.common.js" type="text/javascript"></script>
	
	<!--[if lte IE 7]><script type="text/javascript" src="../src/core/fixes/trident3.js"></script><![endif]-->
	<!--[if IE 8]><script type="text/javascript" src="../src/core/fixes/trident4.js"></script><![endif]-->
	<script type="text/javascript" src="../src/core/prototype.js"></script>
	<script type="text/javascript" src="../src/core/fixes/onhashchange.js"></script>
	<script type="text/javascript" src="../src/modules/event-driven.js"></script>
	<script type="text/javascript" src="../src/modules/location-hash.js"></script>
</head>
<body>
<script type="text/javascript">
Tests.test(function (t)
{
	var a = document.createElement('a')
	
	// makes a.hash to work
	a.href = 'abc'
	
	a.hash = '#123'
	t.eq(a.hash, '#123', 'get')
	
	var text = '#%20& '
	a.hash = encodeURIComponent(text)
	window.location.hash = encodeURIComponent(text)
	t.eq(window.location.hash, a.hash, 'a.hash and location.hash')
	
	
	
	var text = '###%20& Петя … 章亦春 +& '
	
	t.test('decodes on the fly', function (t)
	{
		var a = document.createElement('a')
		a.href = 'abc'
		a.hash = encodeURIComponent(text)
		
		t.eq(a.hash, '#' + text)
	})
	
	t.test('encodes on the fly', function (t)
	{
		var a = document.createElement('a')
		a.href = 'abc'
		a.hash = '#' + text
		
		t.eq(a.hash, '#' + text)
	})
	
	t.test('encodeURI() is enough', function (t)
	{
		var a = document.createElement('a')
		a.href = 'abc'
		a.hash = '#' + encodeURI(text)
		
		t.eq(decodeURIComponent(a.hash), '#' + text)
	})
	
	t.test('encodeURIComponent() works fine', function (t)
	{
		var a = document.createElement('a')
		a.href = 'abc'
		a.hash = '#' + encodeURIComponent(text)
		
		t.eq(decodeURIComponent(a.hash), '#' + text)
	})
})
</script>
</body>
</html>