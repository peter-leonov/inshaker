# Главное

Ни при каких условиях не пишите свои приложения так, чтобы они ожидали что картинка коктейля будет лежать на www.inshaker.ru там, где она лежит сейчас. Или что формат, например, `cocktails.json` или `ingredients.json` не изменится (как раз обязательно изменится). Никто не гарантирует никаких предварительных уведомлений, серверных редиректов, содержательных сообщений об ошибках и тому подобного.

У нас нет API. Помните об этом.

Как тогда быть? Очень просто: пишите скрипт для экспорта данных из репозитория (или прям с сайта) на свой сервер. И забирайте данные уже со своего сервера, а не с www.inshaker.ru. В таком случае, когда формат файлов и их местонахождение изменятся, ваш скрипт предупредит вас об этом (по почте, аське или сам позвонит), а приложение продолжит забирать немного устаревшие данные. И ваше приложение не сломается.

Еще раз прошу быть готовым к постоянным переменам на сайте и в репозитории.


# В целом

Данные хранятся прямо в репозитории в `htdocs/db/*/*.json`. Доступ к ним идет через простые яваскриптовые методы. Например, получить коктейли по тегу «Безалкогольньые» можно набрав в фаербаге `Cocktail.getByTag('Безалкогольные')`. Получим массив объектов. Это может быть полезно, чтобы сверить вашу реализацию поиска с той, что на сайте.


# Ингредиенты

Сами ингредиенты лежат в `htdocs/db/ingredients/ingredients.json`. Рядом с ними лежат файлы `groups.json`, `tags.json` и т.д. с говорящими названиями. `units.json` сейчас на сайте не используется.

В `ingredients.json` лежит массив хешей. Каждый хеш — это ингредиент. Вот пример хеша ингредиента:

	{
		"brand": "Absolut",
		"mark": "Absolut",

`brand` и `mark` могут различаться. Например бренд «Monin Grapefruit» и марка «Monin». Немного неинтуитивно, ну и ладно.

		"group": "Крепкий алкоголь",

Группы бывают разные. Весь список рядом, в `groups.json`.

		"tags": ["Absolut","Любой ингредиент"],

Теги ингредиентов (не путать с тегами коктейлей) широко используются на сайте. Список тоже рядом, в `tags.json`.

		"name": "Водка",

Название, оно же `PRIMARY KEY`, если можно так выразиться.

		"names": ["Absolut", "Абсолют"],

Псевдонимы ингредиента. Появляются в выподающей подсказке, если пользователь набирает не главное имя ингредиента.

		"path": "vodka",

Очень важное свойство. По нему составляется путь к картинкам ингредиента. Подроьнее смотрите `htdocs/js/entities/Cocktail.js` методы `getMiniImageSrc()` и `getMainImageSrc()`.

		"unit": "л",

Единица измерения ингредиента. Список возможных значений ищите в `units.json`.

		"volumes": [[0.7,776.0,true]]

Распространенные объемы выпуска. Первый элемент — количество, второй — стоимость. На третий можно не сомтреть, это реликт.

	}

В папках `htdocs/ingredient/*/` лежат картинки (большая `image.png` и малая `preview.jpg`) и описания (`data.json`) ингредиентов. Имя папки вычисляется на основе `path` так как в методах выше (`/ingredient/${path}/`).


# Коктейли


Копипаста из параграфа про ингрединты. С единственной разницей: там хеш хешей (так уж сложилось исторически). И еще важно: `groups.json`, `methods.json` и `strengths.json` лежат списки «особых» тегов. Особые они только на странице [Сочетайзера](http://www.inshaker.ru/combinator.html#q=Водка&s=by-method). Но это те же теги, что и в `tags.json` и в поле `tags` хеша коктейля.


Пример хеша:

	{
		"name":"Мохито",

Имя, оно же `PRIMARY KEY`.

		"name_eng":"Mojito",

Название на инглише. Полезно при поиске коктейля по международному названию, а также для понимания, где лежит его картинка, и вообще всё остальное.

		"ingredients": [["Белый ром",0.05],["Сахарный сироп",0.015],["Содовая",0.1],["Лайм",25],["Мята",4],["Лед дробленый",250]],

Чего и сколько. Название ингредиента, это его `PRIMARY KEY`.

		"garnish": [["Мята",1]],

Чем украсим.

		"tools":[["Хайбол",1],["Мадлер",1],["Коктейльная ложка",1],["Трубочки",1]],

В чём готовим. Это тоже просто ингредиенты, которые есть в `ingredients.json`.

		"tags":["Алкогольные","Все коктейли","Давят мадлером","Зеленые","Классические","Лаунж","Мохито","Самые популярные","Слабоалкогольные","Холодные"],

Тупо список тегов.

		"added": 1221436800

Когда был добавлен на сайт. Кол-во секунд с начала эпохи. Фаербаг поможет быстро распарсить: `alert(new Date(1221436800 * 1000))`.

	}

Копипаста про папки `htdocs/cocktail/*/`. Там остальное, да.

